(function(t){function e(e){for(var r,o,c=e[0],s=e[1],u=e[2],l=0,f=[];l<c.length;l++)o=c[l],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&f.push(a[o][0]),a[o]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r]);d&&d(e);while(f.length)f.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],r=!0,o=1;o<n.length;o++){var c=n[o];0!==a[c]&&(r=!1)}r&&(i.splice(e--,1),t=s(s.s=n[0]))}return t}var r={},o={app:0},a={app:0},i=[];function c(t){return s.p+"js/"+({}[t]||t)+"."+{"chunk-2d0e453c":"ecb1186b","chunk-2d208333":"d6d7f9e0","chunk-2d21405d":"7b112860","chunk-2d2308b4":"af50daf4","chunk-38cdd219":"4874e546","chunk-6533813f":"bf78a52b","chunk-d69e9b76":"5c61c2ae"}[t]+".js"}function s(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(t){var e=[],n={"chunk-38cdd219":1,"chunk-6533813f":1};o[t]?e.push(o[t]):0!==o[t]&&n[t]&&e.push(o[t]=new Promise((function(e,n){for(var r="css/"+({}[t]||t)+"."+{"chunk-2d0e453c":"31d6cfe0","chunk-2d208333":"31d6cfe0","chunk-2d21405d":"31d6cfe0","chunk-2d2308b4":"31d6cfe0","chunk-38cdd219":"e43275ee","chunk-6533813f":"923f445e","chunk-d69e9b76":"31d6cfe0"}[t]+".css",a=s.p+r,i=document.getElementsByTagName("link"),c=0;c<i.length;c++){var u=i[c],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===r||l===a))return e()}var f=document.getElementsByTagName("style");for(c=0;c<f.length;c++){u=f[c],l=u.getAttribute("data-href");if(l===r||l===a)return e()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=e,d.onerror=function(e){var r=e&&e.target&&e.target.src||a,i=new Error("Loading CSS chunk "+t+" failed.\n("+r+")");i.code="CSS_CHUNK_LOAD_FAILED",i.request=r,delete o[t],d.parentNode.removeChild(d),n(i)},d.href=a;var h=document.getElementsByTagName("head")[0];h.appendChild(d)})).then((function(){o[t]=0})));var r=a[t];if(0!==r)if(r)e.push(r[2]);else{var i=new Promise((function(e,n){r=a[t]=[e,n]}));e.push(r[2]=i);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,s.nc&&l.setAttribute("nonce",s.nc),l.src=c(t);var f=new Error;u=function(e){l.onerror=l.onload=null,clearTimeout(d);var n=a[t];if(0!==n){if(n){var r=e&&("load"===e.type?"missing":e.type),o=e&&e.target&&e.target.src;f.message="Loading chunk "+t+" failed.\n("+r+": "+o+")",f.name="ChunkLoadError",f.type=r,f.request=o,n[1](f)}a[t]=void 0}};var d=setTimeout((function(){u({type:"timeout",target:l})}),12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(e)},s.m=t,s.c=r,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(n,r,function(e){return t[e]}.bind(null,r));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/",s.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=e,u=u.slice();for(var f=0;f<u.length;f++)e(u[f]);var d=l;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var r=n("b3c3"),o=n.n(r);o.a},"07c5":function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r="http://192.168.0.3:8000"},"0e21":function(t,e,n){},4305:function(t,e,n){"use strict";var r=n("9163"),o=n.n(r);o.a},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrapper",attrs:{id:"app"}},[n("Header",{key:t.key,staticClass:"header"}),n("router-view",{staticClass:"content"}),n("Footer",{staticClass:"footer"})],1)},a=[],i=(n("d3b7"),n("96cf"),n("1da1")),c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"main-header"},[t._m(0),n("div",{staticClass:"second-row"},[n("div",{staticClass:"btn-container"},[t.isLoggedIn?t.isLoggedIn?n("q-btn",{staticClass:"login-but",attrs:{color:"blue-10","text-color":"white",label:"Выйти"},on:{click:function(e){return e.preventDefault(),t.logout(e)}}}):t._e():n("q-btn",{staticClass:"login-but",attrs:{color:"white","text-color":"black",label:"Войти"},on:{click:function(e){return e.preventDefault(),t.toLogin(e)}}}),t.isLoggedIn&&"15"===t.getPermission?n("q-btn",{staticClass:"login-but",attrs:{color:"blue-10","text-color":"white",label:"Карточка"},on:{click:function(e){return e.preventDefault(),t.toCard(e)}}}):t.isLoggedIn&&"5"===t.getPermission?n("q-btn",{staticClass:"login-but",attrs:{color:"blue-10","text-color":"white",label:"Районы"},on:{click:function(e){return e.preventDefault(),t.toDistr(e)}}}):t._e()],1),n("div",{staticClass:"to-home-text"},[n("router-link",{staticClass:"router-text",attrs:{to:"/"}},[t._v("Управление обеспечения бюджетного процесса и ресурсного сопровождения учреждений в сфере образования мэрии г. Новосибирска ")])],1)])]),n("hr")])},s=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"welcome-header"},[r("img",{staticClass:"image",attrs:{"data-entity-type":"file",src:n("dbf9")}}),r("div",{staticClass:"text-header"},[r("p",{staticClass:"welcome-header",staticStyle:{margin:"0"}},[t._v("МЭРИЯ ГОРОДА НОВОСИБИРСКА"),r("br"),t._v(" ДЕПАРТАМЕНТ ОБРАЗОВАНИЯ")]),r("br")]),r("img",{staticClass:"image",attrs:{"data-entity-type":"file",src:n("fac1")}})])}],u=(n("b0c0"),{name:"Header",computed:{isLoggedIn:function(){return this.$store.getters.isLoggedIn},getPermission:function(){return console.log(localStorage.getItem("permission")),localStorage.getItem("permission")}},methods:{logout:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("logout").then((function(){e.$router.push("/login")}));case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),toLogin:function(){this.$router.push("/login")},toCard:function(){void 0!==this.$route.params["build"]?this.$router.push("/schoolcard/".concat(this.$route.params["build"])):void 0!==this.$route.params["school"]&&this.$router.push("/schoolcard/".concat(this.$route.params["school"]))},toDistr:function(){"districts"!==this.$route.name&&this.$router.push("/districts")}}}),l=u,f=(n("b5ad"),n("2877")),d=n("fe09"),h=Object(f["a"])(l,c,s,!1,null,"62b4e6c8",null),p=h.exports;h.options.components=Object.assign(Object.create(h.options.components||null),h.options.components||{},{QBtn:d["a"]});var m=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},g=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("footer",{staticClass:"footer"},[n("div",{staticClass:"text"},[n("p",[t._v("Департамент образования мэрии города Новосибирска"),n("br"),n("strong",[t._v("630099, город Новосибирск, ул.Красный проспект, 34 Тел.: 227-45-00")])])])])}],v={name:"Footer"},b=v,w=(n("df70"),Object(f["a"])(b,m,g,!1,null,"2f486eea",null)),k=w.exports,_={components:{Footer:k,Header:p},data:function(){return{key:0}},methods:{update:function(){this.key+=1}},created:function(){this.$http.interceptors.response.use(void 0,function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(){throw 401===e.status&&e.config&&!e.config.__isRetryRequest&&this.$store.dispatch("logout"),e}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},y=_,C=(n("034f"),Object(f["a"])(y,o,a,!1,null,null,null)),x=C.exports,j=(n("45fc"),n("8c4f")),$=n("2f62"),O=n("bc3a"),I=n.n(O),S=n("07c5"),E={actions:{login:function(t,e){return Object(i["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.commit,n.prev=1,n.next=4,new Promise((function(t,n){r("auth_request"),I.a.post(S["a"]+"/accounts/login/",e,{headers:{"Content-Type":"application/json"}}).then((function(e){var n=e.data.data,o=n.token,a=n.user,i=a["permission"];localStorage.setItem("token",o),localStorage.setItem("inn",a["username"]),localStorage.setItem("permission",i),I.a.defaults.headers.common["Authorization"]="auth"+o,r("auth_success",o,a,i),t(n)})).catch((function(t){r("auth_error"),console.log("remove"),localStorage.clear(),r("logout"),n(t)}))}));case 4:return n.abrupt("return",n.sent);case 7:n.prev=7,n.t0=n["catch"](1),console.log(n.t0);case 10:case"end":return n.stop()}}),n,null,[[1,7]])})))()},logout:function(t){return Object(i["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,e.next=3,new Promise((function(t){n("logout"),localStorage.clear(),delete I.a.defaults.headers.common["Authorization"],t()}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))()}}},A={state:{info:{},districts:{}},mutations:{setInfo:function(t,e){t.info=e},setDistricts:function(t,e){t.districts=e}},actions:{fetchInfo:function(t,e){return Object(i["a"])(regeneratorRuntime.mark((function n(){var r,o,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.commit,o=e.token,a=e.inn,n.prev=2,n.next=5,new Promise((function(t,e){I.a.get(S["a"]+"/api/school",{headers:{Authorization:"auth "+o,"Content-Type":"application/json",INN:a}}).then((function(e){var n=e.data.data.school;r("setInfo",n),t(n)})).catch((function(t){e(t)}))}));case 5:return n.abrupt("return",n.sent);case 8:throw n.prev=8,n.t0=n["catch"](2),n.t0;case 11:case"end":return n.stop()}}),n,null,[[2,8]])})))()},fetchDistricts:function(t){return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,e.prev=1,r=localStorage.getItem("token"),e.next=5,new Promise((function(t,e){I.a.get(S["a"]+"/api/districts",{headers:{Authorization:"auth "+r,"Content-Type":"application/json"}}).then((function(e){var r=e.data.data;n("setDistricts",r),t(r)})).catch((function(t){e(t)}))}));case 5:return e.abrupt("return",e.sent);case 8:throw e.prev=8,e.t0=e["catch"](1),e.t0;case 11:case"end":return e.stop()}}),e,null,[[1,8]])})))()},updateInfo:function(t,e){return Object(i["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.commit,n.prev=1,r=localStorage.getItem("token"),n.next=5,new Promise((function(t,n){I.a.put(S["a"]+"/api/school/",e,{headers:{Authorization:"auth "+r,"Content-Type":"application/json"}}).then((function(e){console.log(e),t(e)})).catch((function(t){n(t)}))}));case 5:return n.abrupt("return",n.sent);case 8:n.prev=8,n.t0=n["catch"](1),console.log(n.t0);case 11:case"end":return n.stop()}}),n,null,[[1,8]])})))()},fetchBuilding:function(t,e){return Object(i["a"])(regeneratorRuntime.mark((function n(){var r,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.commit,r=e.token,o=e.inn,n.prev=2,n.next=5,new Promise((function(t,e){I.a.get(S["a"]+"/api/building",{headers:{Authorization:"auth "+r,"Content-Type":"application/json",INN:o}}).then((function(e){t(e)})).catch((function(t){e(t)}))}));case 5:return n.abrupt("return",n.sent);case 8:throw n.prev=8,n.t0=n["catch"](2),n.t0;case 11:case"end":return n.stop()}}),n,null,[[2,8]])})))()}},getters:{info:function(t){return t.info},districts:function(t){return t.districts}}};r["a"].use($["a"]);var P=new $["a"].Store({state:{status:"",token:localStorage.getItem("token")||"",user:{},error:null,permission:""},mutations:{auth_request:function(t){t.status="loading"},auth_success:function(t,e,n,r){t.status="success",t.token=e,t.user=n,t.permission=r},auth_error:function(t){t.status="error"},logout:function(t){t.status="",t.token="",t.user={},t.permission=""},setError:function(t,e){t.error=e},clearError:function(t){t.error=null}},getters:{isLoggedIn:function(t){return!!t.token},authStatus:function(t){return t.status},error:function(t){return t.error},username:function(t){return t.user["username"]},permission:function(t){return t.permission}},modules:{auth:E,info:A}}),R=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},q=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h2",[t._v("Home")])])}],L={name:"Home"},T=L,D=(n("4305"),Object(f["a"])(T,R,q,!1,null,"6e1aa130",null)),N=D.exports;r["a"].use(j["a"]);var z=new j["a"]({mode:"history",routes:[{path:"/",name:"home",component:N},{path:"/districts",name:"districts",meta:{requiresAuth:!0},component:function(){return n.e("chunk-2d208333").then(n.bind(null,"a47a"))}},{path:"/districts/:district",name:"one_district",meta:{requiresAuth:!0},component:function(){return n.e("chunk-38cdd219").then(n.bind(null,"78d4"))},props:!0},{path:"/login",name:"login",component:function(){return n.e("chunk-6533813f").then(n.bind(null,"a55b"))}},{path:"/school/:school",name:"school",meta:{requiresAuth:!0},component:function(){return n.e("chunk-d69e9b76").then(n.bind(null,"feb7"))}},{path:"/schoolcard/:card",name:"schoolcard",meta:{requiresAuth:!0},component:function(){return n.e("chunk-2d21405d").then(n.bind(null,"aebe"))}},{path:"/schoolbuilding/:build",name:"schoolbuilding",meta:{requiresAuth:!0},component:function(){return n.e("chunk-2d0e453c").then(n.bind(null,"906e"))}},{path:"/create_building/:build",name:"CreateBuilding",meta:{requiresAuth:!0},component:function(){return n.e("chunk-2d2308b4").then(n.bind(null,"ed76"))}}]});z.beforeEach((function(t,e,n){if(t.matched.some((function(t){return t.meta.requiresAuth}))){if(P.getters.isLoggedIn)return void n();n("/login")}else n()}));var B=z,H=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container center",staticStyle:{"margin-top":"50px"}},[n("div",{staticClass:"preloader-wrapper active"},[n("div",{staticClass:"spinner-layer",class:t.color},[t._m(0),t._m(1),t._m(2)])])])},M=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"circle-clipper left"},[n("div",{staticClass:"circle"})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"gap-patch"},[n("div",{staticClass:"circle"})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"circle-clipper right"},[n("div",{staticClass:"circle"})])}],F={computed:{color:function(){var t=["spinner-red-only","spinner-green-only","spinner-blue-only"];return t[Math.floor(3*Math.random())]}}},J=F,K=Object(f["a"])(J,H,M,!1,null,null,null),Q=K.exports,U=(n("0e21"),n("e54f"),n("b05d"));r["a"].use(U["a"],{config:{},components:{},directives:{},plugins:{}});n("6885");r["a"].prototype.$http=I.a;var G=localStorage.getItem("token");G&&(r["a"].prototype.$http.defaults.headers.common["Authorization"]=G),r["a"].config.productionTip=!1,r["a"].component("Loader",Q),new r["a"]({router:B,store:P,render:function(t){return t(x)}}).$mount("#app")},9163:function(t,e,n){},b3c3:function(t,e,n){},b5ad:function(t,e,n){"use strict";var r=n("f76d"),o=n.n(r);o.a},dbf9:function(t,e,n){t.exports=n.p+"img/gerb.1e06e495.png"},df70:function(t,e,n){"use strict";var r=n("fdb8"),o=n.n(r);o.a},f76d:function(t,e,n){},fac1:function(t,e,n){t.exports=n.p+"img/gerb-2.41a94b77.png"},fdb8:function(t,e,n){}});
//# sourceMappingURL=app.f271c9bc.js.map